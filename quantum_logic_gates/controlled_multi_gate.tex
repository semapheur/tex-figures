\documentclass[tikz, border=1pt]{standalone}
\usepackage{quantikz}

\begin{document}
\begin{quantikz}[wire types={q,n,q,n,q,n,n,n,q,n,q}]
  \lstick{\ket{x_n}} &[0.1cm] \ctrl{2}\gategroup[11, style={draw=none}]{$\Lambda^n (U)$} &[0.1cm] \midstick[11, brackets=none]{$=$} &[0.1cm] \gategroup[11, style={draw=none,fill=gray!20},background]{$D$} &[0.5cm] \ctrl{2}\gategroup[11, style={draw=none,fill=gray!20},background]{$B$} &[0.5cm] \ctrl{2}\gategroup[11, style={draw=none,fill=gray!20},background]{$C$} &[0.5cm] \ctrl{2}\gategroup[11, style={draw=none,fill=gray!20},background]{$B$} &[0.5cm] \ctrl{4}\gategroup[11, style={draw=none,fill=gray!20},background]{$A$} & \\
  \lstick{\otimes} &&&&&&&& \\[-0.2cm]
  \lstick{\ket{x_{n-1}}} & \ctrl{2} & & \ctrl{2} & \gate{X} & \ctrl{2} & \gate{X} & &  \\[-0.2cm]
  \lstick{\otimes} &&&&&&&& \\
  \lstick{\ket{x_{n-2}}} & \ctrl{1} & & \ctrl{1} & & \ctrl{1} & & \ctrl{1} &  \\
  \lstick{\otimes} &&&&&&&& \\[-0.4cm]
  \lstick{\vdots} & \vdots & & \vdots & & \vdots & & \vdots & \\[-0.2cm]
  \lstick{\otimes} &&&&&&&& \\
  \lstick{\ket{x_1}} & \ctrl{-1} & & \ctrl{-1} & & \ctrl{-1} & & \ctrl{-1} & \\
  \lstick{\otimes} &&&&&&&& \\[-0.2cm]
  \lstick{\ket{x_0}} & \gate{U}\wire[u][2]{q} & & \gate{\sqrt{U}}\wire[u][2]{q} & & \gate{\sqrt{U^\dagger}}\wire[u][2]{q} & & \gate{\sqrt{U}}\wire[u][2]{q} &
\end{quantikz}
\end{document}